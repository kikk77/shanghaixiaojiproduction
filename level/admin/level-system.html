<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç­‰çº§ç³»ç»Ÿç®¡ç†ä¸­å¿ƒ</title>
    <link rel="stylesheet" href="/level/admin/styles/level-system.css">
    <style>
        /* åŸºç¡€æ ·å¼ */
        * { box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: #f5f5f5;
            margin: 0;
            padding: 0;
        }
        
        .admin-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* ç³»ç»ŸçŠ¶æ€ */
        .system-status {
            background: #e8f5e8;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .status-enabled { background: #d4edda; color: #155724; padding: 5px 10px; border-radius: 3px; }
        .status-disabled { background: #f8d7da; color: #721c24; padding: 5px 10px; border-radius: 3px; }
        
        /* æ ‡ç­¾é¡µ */
        .tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            border-bottom: 2px solid #ddd;
            flex-wrap: wrap;
        }
        
        .tab {
            padding: 12px 24px;
            cursor: pointer;
            border: none;
            background: #f8f9fa;
            border-radius: 5px 5px 0 0;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .tab:hover { background: #e9ecef; }
        .tab.active { background: #2196F3; color: white; }
        
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        
        /* è¡¨å•æ ·å¼ */
        .form-section {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 15px 0;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #555;
        }
        
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }
        
        /* æŒ‰é’®æ ·å¼ */
        .btn {
            padding: 10px 20px;
            margin: 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .btn-primary { background: #2196F3; color: white; }
        .btn-primary:hover { background: #1976D2; }
        
        .btn-success { background: #4CAF50; color: white; }
        .btn-success:hover { background: #388E3C; }
        
        .btn-warning { background: #FF9800; color: white; }
        .btn-warning:hover { background: #F57C00; }
        
        .btn-danger { background: #f44336; color: white; }
        .btn-danger:hover { background: #D32F2F; }
        
        /* è¡¨æ ¼æ ·å¼ */
        .config-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        
        .config-table th,
        .config-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        .config-table th {
            background: #f8f9fa;
            font-weight: 600;
        }
        
        .config-table tr:hover {
            background: #f5f5f5;
        }
        
        /* è­¦å‘Šæ¡† */
        .warning-box {
            background: #fff3cd;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 4px solid #ffc107;
        }
        
        /* æˆåŠŸæ¡† */
        .success-box {
            background: #d4edda;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 4px solid #28a745;
        }
        
        /* ä¿¡æ¯æ¡† */
        .info-box {
            background: #d1ecf1;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 4px solid #17a2b8;
        }
        
        /* ç»Ÿè®¡å¡ç‰‡ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .stat-card h3 {
            margin: 0 0 10px 0;
            color: #666;
            font-size: 14px;
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: bold;
            color: #2196F3;
        }
        
        /* å‹‹ç« æ ·å¼ */
        .badge-item {
            display: inline-block;
            background: #fff3cd;
            padding: 8px 12px;
            margin: 5px;
            border-radius: 20px;
            border: 1px solid #ffeaa7;
        }
        
        .badge-rarity-common { background: #e0e0e0; }
        .badge-rarity-rare { background: #bbdefb; }
        .badge-rarity-epic { background: #ce93d8; }
        .badge-rarity-legendary { background: #ffcc80; }
        
        /* æ¨¡æ€æ¡† */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            overflow-y: auto;
        }
        
        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 25px;
            width: 90%;
            max-width: 500px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            text-align: left;
        }
        
        .modal-close {
            position: absolute;
            right: 20px;
            top: 20px;
            font-size: 28px;
            cursor: pointer;
            color: #999;
        }
        
        .modal-close:hover {
            color: #333;
        }
        
        /* å˜é‡æŒ‰é’® */
        .variable-btn {
            background: #e3f2fd;
            border: 1px solid #2196F3;
            padding: 5px 10px;
            margin: 2px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .variable-btn:hover {
            background: #bbdefb;
        }
        
        /* é¢„è§ˆæ¡† */
        .preview-box {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 5px;
            margin-top: 10px;
            white-space: pre-wrap;
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <h1>ğŸ† ç­‰çº§ç³»ç»Ÿç®¡ç†ä¸­å¿ƒ</h1>
        
        <!-- ç³»ç»ŸçŠ¶æ€ -->
        <div class="system-status">
            <div>
                <strong>ç­‰çº§ç³»ç»ŸçŠ¶æ€ï¼š</strong>
                <span id="systemStatus" class="status-enabled">å·²å¯ç”¨</span>
                <span style="margin-left: 20px;">æ•°æ®åº“ï¼šlevel_system.db</span>
            </div>
            <div>
                <button class="btn btn-warning" onclick="toggleLevelSystem()">åˆ‡æ¢çŠ¶æ€</button>
                <button class="btn btn-primary" onclick="manualRefresh()" style="margin-left: 10px;">ğŸ”„ åˆ·æ–°æ•°æ®</button>
            </div>
        </div>
        
        <!-- ç»Ÿè®¡æ¦‚è§ˆ -->
        <div class="stats-grid">
            <div class="stat-card">
                <h3>ğŸ‘¥ æ€»ç”¨æˆ·æ•°</h3>
                <div class="stat-value" id="totalUsers">-</div>
            </div>
            <div class="stat-card">
                <h3>ğŸ† æ€»ç§¯åˆ†å‘æ”¾</h3>
                <div class="stat-value" id="totalPoints">-</div>
            </div>
            <div class="stat-card">
                <h3>â­ å¹³å‡ç­‰çº§</h3>
                <div class="stat-value" id="avgLevel">-</div>
            </div>
            <div class="stat-card">
                <h3>ğŸ–ï¸ å‹‹ç« æ€»æ•°</h3>
                <div class="stat-value" id="totalBadges">-</div>
            </div>
        </div>
        
        <!-- æ ‡ç­¾é¡µ -->
        <div class="tabs">
            <button class="tab active" onclick="switchTab('users')">ğŸ‘¥ ç”¨æˆ·ç®¡ç†</button>
            <button class="tab" onclick="switchTab('levels')">â­ ç­‰çº§é…ç½®</button>
            <button class="tab" onclick="switchTab('rewards')">ğŸ å¥–åŠ±è§„åˆ™</button>
            <button class="tab" onclick="switchTab('badges')">ğŸ† å‹‹ç« ç®¡ç†</button>
            <button class="tab" onclick="switchTab('broadcast')">ğŸ“¢ æ’­æŠ¥é…ç½®</button>
            <button class="tab" onclick="switchTab('groups')">ğŸ‘¥ ç¾¤ç»„ç®¡ç†</button>
            <button class="tab" onclick="switchTab('data')">ğŸ’¾ æ•°æ®ç®¡ç†</button>
        </div>
        
        <!-- ç”¨æˆ·ç®¡ç† -->
        <div id="users-tab" class="tab-content active">
            <div class="form-section">
                <h2>ğŸ” ç”¨æˆ·æœç´¢</h2>
                <div class="form-grid">
                    <div>
                        <input type="text" id="userSearchInput" placeholder="è¾“å…¥ç”¨æˆ·IDæˆ–æ˜¾ç¤ºåç§°">
                        <button class="btn btn-primary" onclick="searchUser()">æœç´¢</button>
                    </div>
                </div>
                
                <div id="userSearchResult" style="display: none;">
                    <!-- æœç´¢ç»“æœå°†æ˜¾ç¤ºåœ¨è¿™é‡Œ -->
                </div>
            </div>
            
            <div class="form-section">
                <h2>ğŸ“Š ç”¨æˆ·æ’è¡Œæ¦œ</h2>
                <table class="config-table">
                    <thead>
                        <tr>
                            <th>æ’å</th>
                            <th>ç”¨æˆ·</th>
                            <th>ç­‰çº§</th>
                            <th>ç»éªŒå€¼</th>
                            <th>ç§¯åˆ†</th>
                            <th>æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="userRankingBody">
                        <tr><td colspan="6" style="text-align: center;">åŠ è½½ä¸­...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- ç­‰çº§é…ç½® -->
        <div id="levels-tab" class="tab-content">
            <div class="form-section">
                <h2>âš™ï¸ ç­‰çº§é…ç½®ç®¡ç†</h2>
                
                <div class="form-group">
                    <label>é€‰æ‹©ç¾¤ç»„ï¼š</label>
                    <select id="levelGroupSelect" onchange="loadGroupLevelConfig()">
                        <option value="default">é»˜è®¤ç¾¤ç»„</option>
                    </select>
                    <button class="btn btn-success" onclick="createNewGroup()">åˆ›å»ºæ–°ç¾¤ç»„</button>
                </div>
                
                <table class="config-table" id="levelConfigTable">
                    <thead>
                        <tr>
                            <th>ç­‰çº§</th>
                            <th>ç­‰çº§åç§°</th>
                            <th>æ‰€éœ€ç»éªŒå€¼</th>
                            <th>æ‰€éœ€è¯„ä»·æ¬¡æ•°</th>
                            <th>æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="levelConfigBody">
                        <!-- åŠ¨æ€ç”Ÿæˆ -->
                    </tbody>
                </table>
                
                <button class="btn btn-primary" onclick="addLevelRow()">â• æ·»åŠ ç­‰çº§</button>
                <button class="btn btn-success" onclick="saveLevelConfig()">ğŸ’¾ ä¿å­˜é…ç½®</button>
                <button class="btn btn-warning" onclick="resetLevelConfig()">ğŸ”„ é‡ç½®ä¸ºé»˜è®¤</button>
            </div>
        </div>
        
        <!-- å¥–åŠ±è§„åˆ™ -->
        <div id="rewards-tab" class="tab-content">
            <div class="form-section">
                <h2>ğŸ å¥–åŠ±è§„åˆ™é…ç½®</h2>
                
                <h3>åŸºç¡€å¥–åŠ±ï¼ˆç»éªŒå€¼ + ç§¯åˆ†ï¼‰</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label>ğŸ¯ å®Œæˆå‡ºå‡»</label>
                        <input type="number" id="attackExp" placeholder="ç»éªŒå€¼" value="20">
                        <input type="number" id="attackPoints" placeholder="ç§¯åˆ†" value="10">
                    </div>
                    <div class="form-group">
                        <label>ğŸ“ 12é¡¹è¯„ä»·</label>
                        <input type="number" id="userEvalExp" placeholder="ç»éªŒå€¼" value="30">
                        <input type="number" id="userEvalPoints" placeholder="ç§¯åˆ†" value="25">
                    </div>
                    <div class="form-group">
                        <label>ğŸª å•†å®¶è¯„ä»·</label>
                        <input type="number" id="merchantEvalExp" placeholder="ç»éªŒå€¼" value="25">
                        <input type="number" id="merchantEvalPoints" placeholder="ç§¯åˆ†" value="20">
                    </div>
                    <div class="form-group">
                        <label>âœï¸ æ–‡å­—è¯„ä»·</label>
                        <input type="number" id="textEvalExp" placeholder="ç»éªŒå€¼" value="15">
                        <input type="number" id="textEvalPoints" placeholder="ç§¯åˆ†" value="15">
                    </div>
                </div>
                
                <h3>ç‰¹æ®Šå¥–åŠ±</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label>ğŸ’¯ æ»¡åˆ†å¥–åŠ±</label>
                        <input type="number" id="perfectScoreExp" placeholder="é¢å¤–ç»éªŒå€¼" value="50">
                        <input type="number" id="perfectScorePoints" placeholder="é¢å¤–ç§¯åˆ†" value="100">
                    </div>
                    <div class="form-group">
                        <label>ğŸŠ å‡çº§å¥–åŠ±</label>
                        <input type="number" id="levelUpPoints" placeholder="å¥–åŠ±ç§¯åˆ†" value="50">
                    </div>
                </div>
                
                <h3>å¥–åŠ±å€æ•°</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label>ç»éªŒå€¼å€æ•°</label>
                        <input type="number" id="expMultiplier" step="0.1" value="1.0">
                    </div>
                    <div class="form-group">
                        <label>ç§¯åˆ†å€æ•°</label>
                        <input type="number" id="pointsMultiplier" step="0.1" value="1.0">
                    </div>
                    <div class="form-group">
                        <label>å‘¨æœ«å¥–åŠ±å€æ•°</label>
                        <input type="number" id="weekendBonus" step="0.1" value="1.2">
                    </div>
                </div>
                
                <button class="btn btn-success" onclick="saveRewardsConfig()">ğŸ’¾ ä¿å­˜å¥–åŠ±é…ç½®</button>
            </div>
        </div>
        
        <!-- å‹‹ç« ç®¡ç† -->
        <div id="badges-tab" class="tab-content">
            <div class="form-section">
                <h2>ğŸ† å‹‹ç« ç®¡ç†</h2>
                
                <button class="btn btn-primary" onclick="showCreateBadgeModal()">â• åˆ›å»ºæ–°å‹‹ç« </button>
                
                <div id="badgesList" style="margin-top: 20px;">
                    <!-- å‹‹ç« åˆ—è¡¨ -->
                </div>
            </div>
        </div>
        
        <!-- æ’­æŠ¥é…ç½® -->
        <div id="broadcast-tab" class="tab-content">
            <div class="form-section">
                <h2>ğŸ“¢ æ’­æŠ¥é…ç½®</h2>
                
                <h3>æ’­æŠ¥å¼€å…³</h3>
                <div class="form-grid">
                    <label><input type="checkbox" id="enableLevelUp" checked> å‡çº§æ’­æŠ¥</label>
                    <label><input type="checkbox" id="enableBadgeUnlock" checked> å‹‹ç« è§£é”æ’­æŠ¥</label>
                    <label><input type="checkbox" id="enableMilestone"> é‡Œç¨‹ç¢‘æ’­æŠ¥</label>
                    <label><input type="checkbox" id="enablePerfectScore"> æ»¡åˆ†æ’­æŠ¥</label>
                </div>
                
                <h3>æ’­æŠ¥æ¨¡æ¿</h3>
                <div class="form-group">
                    <label>å‡çº§æ’­æŠ¥æ¨¡æ¿ï¼š</label>
                    <textarea id="levelUpTemplate" rows="5">ğŸ‰ æ­å–œ {{user_name}} å‡çº§äº†ï¼
â­ Lv.{{old_level}} â†’ Lv.{{new_level}} {{level_name}}
ğŸ’ å‡çº§å¥–åŠ±ï¼š{{level_up_points}}ç§¯åˆ†
ç»§ç»­åŠªåŠ›ï¼Œæˆä¸ºä¼ è¯´å‹‡å£«ï¼ğŸ’ª</textarea>
                    <div class="variable-list">
                        å¯ç”¨å˜é‡ï¼š
                        <button class="variable-btn" onclick="insertVariable('levelUpTemplate', '{{user_name}}')">{{user_name}}</button>
                        <button class="variable-btn" onclick="insertVariable('levelUpTemplate', '{{old_level}}')">{{old_level}}</button>
                        <button class="variable-btn" onclick="insertVariable('levelUpTemplate', '{{new_level}}')">{{new_level}}</button>
                        <button class="variable-btn" onclick="insertVariable('levelUpTemplate', '{{level_name}}')">{{level_name}}</button>
                        <button class="variable-btn" onclick="insertVariable('levelUpTemplate', '{{level_up_points}}')">{{level_up_points}}</button>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>å‹‹ç« è§£é”æ¨¡æ¿ï¼š</label>
                    <textarea id="badgeUnlockTemplate" rows="4">ğŸ† {{user_name}} è§£é”äº†æ–°å‹‹ç« ï¼
{{badge_emoji}} {{badge_name}}
{{badge_desc}}</textarea>
                    <div class="variable-list">
                        å¯ç”¨å˜é‡ï¼š
                        <button class="variable-btn" onclick="insertVariable('badgeUnlockTemplate', '{{user_name}}')">{{user_name}}</button>
                        <button class="variable-btn" onclick="insertVariable('badgeUnlockTemplate', '{{badge_emoji}}')">{{badge_emoji}}</button>
                        <button class="variable-btn" onclick="insertVariable('badgeUnlockTemplate', '{{badge_name}}')">{{badge_name}}</button>
                        <button class="variable-btn" onclick="insertVariable('badgeUnlockTemplate', '{{badge_desc}}')">{{badge_desc}}</button>
                    </div>
                </div>
                
                <button class="btn btn-success" onclick="saveBroadcastConfig()">ğŸ’¾ ä¿å­˜æ’­æŠ¥é…ç½®</button>
                <button class="btn btn-primary" onclick="testBroadcast()">ğŸ§ª æµ‹è¯•æ’­æŠ¥</button>
            </div>
        </div>
        
        <!-- ç¾¤ç»„ç®¡ç† -->
        <div id="groups-tab" class="tab-content">
            <div class="form-section">
                <h2>ğŸ‘¥ ç¾¤ç»„ç®¡ç†</h2>
                
                <table class="config-table">
                    <thead>
                        <tr>
                            <th>ç¾¤ç»„ID</th>
                            <th>ç¾¤ç»„åç§°</th>
                            <th>ç”¨æˆ·æ•°</th>
                            <th>çŠ¶æ€</th>
                            <th>æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="groupsTableBody">
                        <tr><td colspan="5" style="text-align: center;">åŠ è½½ä¸­...</td></tr>
                    </tbody>
                </table>
                
                <button class="btn btn-primary" onclick="showCreateGroupModal()">â• åˆ›å»ºæ–°ç¾¤ç»„</button>
                <button class="btn btn-success" onclick="loadGroups()" style="margin-left: 10px;">ğŸ”„ åˆ·æ–°åˆ—è¡¨</button>
            </div>
        </div>
        
        <!-- æ•°æ®ç®¡ç† -->
        <div id="data-tab" class="tab-content">
            <div class="form-section">
                <h2>ğŸ’¾ æ•°æ®ç®¡ç†</h2>
                
                <div class="info-box">
                    <p><strong>æ•°æ®åº“æ–‡ä»¶ï¼š</strong>level_system.db</p>
                    <p><strong>æ•°æ®åº“å¤§å°ï¼š</strong><span id="dbSize">-</span></p>
                    <p><strong>æœ€åæ›´æ–°ï¼š</strong><span id="lastUpdate">-</span></p>
                </div>
                
                <h3>æ•°æ®å¯¼å‡º</h3>
                <div class="form-grid">
                    <button class="btn btn-primary" onclick="exportAllData()">ğŸ“¤ å¯¼å‡ºå®Œæ•´æ•°æ®</button>
                    <button class="btn btn-primary" onclick="exportUserData()">ğŸ‘¥ å¯¼å‡ºç”¨æˆ·æ•°æ®</button>
                    <button class="btn btn-primary" onclick="exportConfig()">âš™ï¸ å¯¼å‡ºé…ç½®</button>
                </div>
                
                <h3>æ•°æ®å¯¼å…¥</h3>
                <div class="warning-box">
                    âš ï¸ å¯¼å…¥æ•°æ®ä¼šè¦†ç›–ç°æœ‰æ•°æ®ï¼Œè¯·è°¨æ…æ“ä½œï¼
                </div>
                <input type="file" id="importFile" accept=".json">
                <button class="btn btn-warning" onclick="importData()">ğŸ“¥ å¯¼å…¥æ•°æ®</button>
                
                <h3>ç¾¤ç»„è¿ç§»</h3>
                <div class="form-grid">
                    <div class="form-group">
                        <label>æºç¾¤ç»„ï¼š</label>
                        <select id="sourceGroup">
                            <option value="">é€‰æ‹©æºç¾¤ç»„</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>ç›®æ ‡ç¾¤ç»„IDï¼š</label>
                        <input type="text" id="targetGroupId" placeholder="-1001234567890">
                    </div>
                </div>
                <button class="btn btn-warning" onclick="migrateGroup()">ğŸ”„ è¿ç§»ç¾¤ç»„</button>
            </div>
        </div>
    </div>
    
    <!-- åˆ›å»ºå‹‹ç« æ¨¡æ€æ¡† -->
    <div id="createBadgeModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal('createBadgeModal')">&times;</span>
            <h2>âœ¨ åˆ›å»ºæ–°å‹‹ç« </h2>
            
            <div class="form-group">
                <label>å‹‹ç« IDï¼š</label>
                <input type="text" id="newBadgeId" placeholder="ä¾‹å¦‚ï¼šperfect_warrior">
            </div>
            
            <div class="form-group">
                <label>å‹‹ç« åç§°ï¼š</label>
                <input type="text" id="newBadgeName" placeholder="ä¾‹å¦‚ï¼šå®Œç¾æˆ˜å£«">
            </div>
            
            <div class="form-group">
                <label>å‹‹ç« å›¾æ ‡ï¼š</label>
                <input type="text" id="newBadgeEmoji" placeholder="ä¾‹å¦‚ï¼šğŸ†" value="ğŸ†">
            </div>
            
            <div class="form-group">
                <label>å‹‹ç« æè¿°ï¼š</label>
                <textarea id="newBadgeDesc" placeholder="ä¾‹å¦‚ï¼šè¿ç»­10æ¬¡è·å¾—æ»¡åˆ†è¯„ä»·"></textarea>
            </div>
            
            <div class="form-group">
                <label>ç¨€æœ‰åº¦ï¼š</label>
                <select id="newBadgeRarity">
                    <option value="common">æ™®é€š âšª</option>
                    <option value="rare">ç¨€æœ‰ ğŸ”µ</option>
                    <option value="epic">å²è¯— ğŸŸ£</option>
                    <option value="legendary">ä¼ è¯´ ğŸŸ¡</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>è§£é”æ¡ä»¶ç±»å‹ï¼š</label>
                <select id="badgeConditionType" onchange="updateConditionForm()">
                    <option value="stat_based">åŸºäºç»Ÿè®¡æ•°æ®</option>
                    <option value="evaluation_streak">è¯„ä»·è¿å‡»</option>
                    <option value="manual">æ‰‹åŠ¨æˆäºˆ</option>
                </select>
            </div>
            
            <div id="conditionDetails">
                <!-- åŠ¨æ€ç”Ÿæˆæ¡ä»¶è¡¨å• -->
            </div>
            
            <button class="btn btn-success" onclick="createBadge()">åˆ›å»ºå‹‹ç« </button>
        </div>
    </div>
    
    <!-- åˆ›å»ºç¾¤ç»„æ¨¡æ€æ¡† -->
    <div id="createGroupModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal('createGroupModal')">&times;</span>
            <h2>â• åˆ›å»ºæ–°ç¾¤ç»„</h2>
            
            <div class="form-group">
                <label>ç¾¤ç»„IDï¼š</label>
                <input type="text" id="newGroupId" placeholder="ä¾‹å¦‚ï¼š-1001234567890">
                <small style="display: block; color: #666;">è¯·è¾“å…¥Telegramç¾¤ç»„IDï¼ˆé€šå¸¸ä»¥-100å¼€å¤´ï¼‰</small>
            </div>
            
            <div class="form-group">
                <label>ç¾¤ç»„åç§°ï¼š</label>
                <input type="text" id="newGroupName" placeholder="ä¾‹å¦‚ï¼šæµ‹è¯•ç¾¤ç»„">
            </div>
            
            <button class="btn btn-success" onclick="createGroup()">åˆ›å»ºç¾¤ç»„</button>
        </div>
    </div>
    
    <!-- ç”¨æˆ·è¯¦æƒ…æ¨¡æ€æ¡† -->
    <div id="userDetailModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal('userDetailModal')">&times;</span>
            <h2>ğŸ‘¤ ç”¨æˆ·è¯¦æƒ…</h2>
            
            <div id="userDetailContent">
                <!-- ç”¨æˆ·è¯¦æƒ…å†…å®¹ -->
            </div>
            
            <h3>è°ƒæ•´ç­‰çº§æ•°æ®</h3>
            <div class="form-grid">
                <div class="form-group">
                    <label>ç»éªŒå€¼è°ƒæ•´ï¼š</label>
                    <input type="number" id="adjustExp" placeholder="æ­£æ•°å¢åŠ ï¼Œè´Ÿæ•°å‡å°‘">
                </div>
                <div class="form-group">
                    <label>ç§¯åˆ†è°ƒæ•´ï¼š</label>
                    <input type="number" id="adjustPoints" placeholder="æ­£æ•°å¢åŠ ï¼Œè´Ÿæ•°å‡å°‘">
                </div>
            </div>
            <div class="form-group">
                <label>è°ƒæ•´åŸå› ï¼š</label>
                <input type="text" id="adjustReason" placeholder="è¯·è¾“å…¥è°ƒæ•´åŸå› ">
            </div>
            <button class="btn btn-warning" onclick="adjustUserData()">æ‰§è¡Œè°ƒæ•´</button>
            
            <h3>æˆäºˆå‹‹ç« </h3>
            <div class="form-group">
                <select id="awardBadgeSelect">
                    <option value="">é€‰æ‹©å‹‹ç« </option>
                </select>
                <button class="btn btn-success" onclick="awardBadge()">æˆäºˆå‹‹ç« </button>
            </div>
        </div>
    </div>
    
    <!-- æ¶ˆæ¯å®¹å™¨ -->
    <div id="messageContainer"></div>
    
    <!-- ç®¡ç†å‘˜å¯†ç éªŒè¯æ¨¡æ€æ¡† -->
    <div id="adminPasswordModal" class="modal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal('adminPasswordModal')">&times;</span>
            <h2>ğŸ” ç®¡ç†å‘˜å¯†ç éªŒè¯</h2>
            <p id="passwordPromptText">æ­¤æ“ä½œéœ€è¦ç®¡ç†å‘˜å¯†ç éªŒè¯ï¼Œè¯·è¾“å…¥å¯†ç ï¼š</p>
            
            <div class="form-group">
                <label>ç®¡ç†å‘˜å¯†ç ï¼š</label>
                <input type="password" id="adminPasswordInput" placeholder="è¯·è¾“å…¥ç®¡ç†å‘˜å¯†ç ">
            </div>
            
            <div style="display: flex; gap: 10px; justify-content: flex-end;">
                <button class="btn btn-secondary" onclick="closeModal('adminPasswordModal')">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="confirmAdminAction()">ç¡®è®¤</button>
            </div>
        </div>
    </div>
    
    <script src="/level/admin/level-system.js"></script>
</body>
</html> 